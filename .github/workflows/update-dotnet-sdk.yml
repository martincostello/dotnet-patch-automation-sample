# This workflow uses a reusable workfrom from martincostello/update-dotnet-sdk
# which uses the martincostello/update-dotnet-sdk GitHub Action and the dotnet-outdated
# global tool to update the .NET SDK and Microsoft-published NuGet packages for
# the application in this repository to the latest patch version on a weekly basis.

name: update-dotnet-sdk

on:
  # Run at 2100 UTC on Tuesday every week to pick up any updates from
  # Patch Tuesday which occur on the second Tuesday of the month (PST).
  schedule:
    - cron:  '00 21 * * TUE'
  # Also support running the workflow manually on-demand.
  workflow_dispatch:

# Set the minumum permissions for GITHUB_TOKEN.
# Use the commented-out additional permission if using GITHUB_TOKEN.
permissions:
  contents: read
  #pull-requests: read

jobs:

  update-sdk:

    uses: martincostello/update-dotnet-sdk/.github/workflows/update-dotnet-sdk.yml@main

    # Set minimum required write permissions if using GITHUB_TOKEN.
    #permissions:
    #  contents: write
    #  pull-requests: write

    # Using a real user/email is recommended instead of using GITHUB_TOKEN, otherwise pull
    # requests opened by this workflow, and commits pushed, will not queue your CI status checks.
    # Similarly, the approve-and-merge workflow will also not run if GITHUB_TOKEN is used.
    # See https://docs.github.com/en/actions/using-workflows/triggering-a-workflow#triggering-a-workflow-from-a-workflow
    # The Git commit user name and email are set as variables in the organization or repository settings.
    # See https://docs.github.com/en/actions/learn-github-actions/variables
    with:
      labels: "dependencies,.NET"
      user-email: ${{ vars.GIT_COMMIT_USER_EMAIL }}
      user-name: ${{ vars.GIT_COMMIT_USER_NAME }}
    secrets:
      repo-token: ${{ secrets.ACCESS_TOKEN }}
